# Token based system
## Key characteristics:
- Who should generate the token? Server, it is not the client as it could be spoofed up ==> Security flow.
- Who validates the token? Server
- Client wants to read info from the token.
- Token should be unique to the user.
- Token should also have expiry time.


## Design this system:
1. Generate and store it in DB? Unnecessary DB call.

2. Token be self contained.


Header.Payload.Signature

Header - contains some information about the JWT payload. Type of token, algorithm used etc.
Payload - contains the information abut the user and extra info like the expiration time.
Signature - very very unique, the key of JWT. This signature is generated by using information in header, payload and the secret owned by the system. Combining all three generates a signature. Signature is just a hash. Even the slightest changes in the header or the payload changes the signature. And if you do not have the secret then too the signature changes. That means it is taper proof.
Secret is owned by the service. So if you can hash it, you can also validate the hash using the same signature. No db call.

In the payload we keep some user info and this might be needed on the client side. We may want to keep the token in such a way that the information could be used by the client. That is why the entire JWT is encoded, encoded using Base64 algorithm and can be decoded on the client side using Base64.

# If you change the header
→ The header segment of the token changes
→ And since the signature is computed over header + payload,
the signature also changes.

# If you change the payload
→ The payload segment changes
→ And again, because signature = sign(header + payload),
the signature also changes


JWT token --> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMn0.KMUFsIDTnFmyG3nMiGM6H9FNFUROf3wh7SmqJp-QV30

The **third element (Signature)** gets changed by the change in **header, payload, and the secret key (ownned by the service)**.
**Until and unless you have the key the token can not be validated. Token can be decoded but not validated.**

That means we can get information out of JWT but can not validate it.
Payloads: user data?
id:, email:, but it should not have sensitive information as this encoded and can be decoded, so if info like password is decoded that can pose security challenge.


**How do you log out the user?**
Blacklist a token:
